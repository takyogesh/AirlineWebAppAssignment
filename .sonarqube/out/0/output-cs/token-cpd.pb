÷
`C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\ApiModel\AirLineApiModel.cs
	namespace 	
AirlineWebApp
 
. 
ApiModel  
{ 
public 

class 
AirLineApiModel  
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
FromCity 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
?		 
ToCity		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 
int

 
Fare

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
} 
} èl
eC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Controllers\AccountController.cs
	namespace		 	
AirlineWebApp		
 
.		 
Controllers		 #
{

 
public 

class 
AccountController "
:# $

Controller% /
{ 
private 
readonly 
AirLineDbContext )
_context* 2
;2 3
public 
AccountController  
(  !
AirLineDbContext! 1
context2 9
)9 :
{ 	
_context 
= 
context 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
HttpContext& 1
.1 2
Session2 9
.9 :
	GetString: C
(C D
$strD J
)J K
)K L
)L M
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 7
)7 8
;8 9
} 
else 
{ 
return 
View 
( 
) 
; 
} 
} 	
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
IsEmailExsist) 6
(6 7
string7 =
email> C
)C D
{ 	
if   
(   
!   
string   
.   
IsNullOrEmpty   %
(  % &
email  & +
)  + ,
)  , -
{!! 
var"" 
finduser""  
=""! "
await""# (
_context"") 1
.""1 2
User""2 6
!""6 7
.""7 8
FirstOrDefaultAsync""8 K
(""K L
x""L M
=>""N P
x""Q R
.""R S
Email""S X
==""Y [
email""\ a
)""a b
;""b c
if## 
(## 
finduser##  
!=##! #
null##$ (
)##( )
{$$ 
return%% 
Ok%% !
(%%! "
$str%%" )
)%%) *
;%%* +
}&& 
}'' 
return(( 
Ok(( 
((( 
$str((  
)((  !
;((! "
})) 	
[** 	
HttpPost**	 
]** 
public++ 
IActionResult++ 
Create++ #
(++# $
User++$ (
user++) -
)++- .
{,, 	
var-- 
Isemail-- 
=-- 
_context-- !
.--! "
User--" &
!--& '
.--' (
FirstOrDefault--( 6
(--6 7
u--7 8
=>--8 :
u--: ;
.--; <
Email--< A
==--A C
user--C G
.--G H
Email--H M
)--M N
;--N O
if.. 
(.. 
Isemail.. 
!=.. 
null.. 
).. 
{// 
return00 
RedirectToAction00 '
(00' (
nameof00( .
(00. /
Index00/ 4
)004 5
)005 6
;006 7
}11 
else22 
{33 
_context44 
.44 
User44 
!44 
.44 
Add44 "
(44" #
user44# '
)44' (
;44( )
_context55 
.55 
SaveChanges55 $
(55$ %
)55% &
;55& '
var66 
role66 
=66 
_context66 #
.66# $
Role66$ (
!66( )
.66) *
FirstOrDefault66* 8
(668 9
r669 :
=>66; =
r66> ?
.66? @
Id66@ B
==66C E
user66F J
.66J K
RoleId66K Q
)66Q R
;66R S
if77 
(77 
role77 
!=77 
null77  
)77  !
{88 
bool99 
send99 
=99 
	EmailSend99 '
(99' (
user99( ,
.99, -
Email99- 2
!992 3
)993 4
;994 5
if:: 
(:: 
role:: 
.:: 
Name:: !
==::" $
$str::% ,
)::, -
{;; 
return<< 
RedirectToAction<< /
(<</ 0
$str<<0 7
)<<7 8
;<<8 9
}== 
else>> 
if>> 
(>> 
role>> !
.>>! "
Name>>" &
==>>' )
$str>>* 4
)>>4 5
{?? 
return@@ 
RedirectToAction@@ /
(@@/ 0
$str@@0 7
)@@7 8
;@@8 9
}AA 
}BB 
returnCC 
RedirectToActionCC '
(CC' (
nameofCC( .
(CC. /
IndexCC/ 4
)CC4 5
)CC5 6
;CC6 7
}DD 
}EE 	
[FF 	
HttpGetFF	 
]FF 
publicGG 
IActionResultGG 
LoginGG "
(GG" #
)GG# $
{HH 	
ifII 
(II 
!II 
stringII 
.II 
IsNullOrEmptyII %
(II% &
HttpContextII& 1
.II1 2
SessionII2 9
.II9 :
	GetStringII: C
(IIC D
$strIID J
)IIJ K
)IIK L
)IIL M
{JJ 
returnKK 
RedirectToActionKK '
(KK' (
$strKK( /
,KK/ 0
$strKK1 7
)KK7 8
;KK8 9
}LL 
elseMM 
{NN 
returnOO 
ViewOO 
(OO 
)OO 
;OO 
}PP 
}QQ 	
[RR 	
HttpPostRR	 
]RR 
publicSS 
asyncSS 
TaskSS 
<SS 
IActionResultSS '
>SS' (
LoginSS) .
(SS. /
stringSS/ 5
EmailSS6 ;
,SS; <
stringSS< B
passwordSSC K
)SSK L
{TT 	
varUU 
IsuserUU 
=UU 
awaitUU 
_contextUU %
.UU% &
UserUU& *
!UU* +
.UU+ ,
FirstOrDefaultAsyncUU, ?
(UU? @
uUU@ A
=>UUA C
uUUC D
.UUD E
EmailUUE J
==UUJ L
EmailUUL Q
&&UUR T
uUUU V
.UUV W
PasswordUUW _
==UU_ a
passwordUUa i
)UUi j
;UUj k
ifVV 
(VV 
IsuserVV 
!=VV 
nullVV 
&&VV !
IsuserVV" (
.VV( )
StatusVV) /
!=VV/ 1
$strVV1 :
&&VV; =
IsuserVV> D
.VVD E
StatusVVE K
!=VVK M
$strVVM U
)VVU V
{WW 
HttpContextXX 
.XX 
SessionXX #
.XX# $
	SetStringXX$ -
(XX- .
$strXX. 4
,XX4 5
IsuserXX6 <
.XX< =
EmailXX= B
!XXB C
)XXC D
;XXD E
varYY 
rolYY 
=YY 
_contextYY  
.YY  !
RoleYY! %
!YY% &
.YY& '

FirstAsyncYY' 1
(YY1 2
rYY2 3
=>YY4 6
rYY7 8
.YY8 9
IdYY9 ;
==YY; =
IsuserYY= C
.YYC D
RoleIdYYD J
)YYJ K
.YYK L
ResultYYL R
;YYR S
HttpContextZZ 
.ZZ 
SessionZZ #
.ZZ# $
SetInt32ZZ$ ,
(ZZ, -
$strZZ- 5
,ZZ5 6
IsuserZZ7 =
.ZZ= >
RoleIdZZ> D
)ZZD E
;ZZE F
HttpContext[[ 
.[[ 
Session[[ #
.[[# $
	SetString[[$ -
([[- .
$str[[. 4
,[[4 5
rol[[6 9
.[[9 :
Name[[: >
![[> ?
)[[? @
;[[@ A
var\\ 
role\\ 
=\\ 
await\\ 
_context\\  (
.\\( )
Role\\) -
!\\- .
.\\. /
FirstOrDefaultAsync\\/ B
(\\B C
r\\C D
=>\\E G
r\\H I
.\\I J
Id\\J L
==\\M O
Isuser\\P V
.\\V W
RoleId\\W ]
)\\] ^
;\\^ _
if]] 
(]] 
role]] 
!]] 
.]] 
Name]] 
==]] !
$str]]" )
)]]) *
{^^ 
return__ 
RedirectToAction__ +
(__+ ,
$str__, 3
,__3 4
$str__5 ;
,__; <
new__= @
{__A B
area__C G
=__H I
$str__J P
}__Q R
)__R S
;__S T
}`` 
elseaa 
ifaa 
(aa 
roleaa 
!aa 
.aa 
Nameaa "
==aa# %
$straa& 0
)aa0 1
{bb 
returncc 
RedirectToActioncc +
(cc+ ,
$strcc, 3
,cc3 4
$strcc5 ;
,cc; <
newcc= @
{ccA B
areaccC G
=ccH I
$strccJ P
}ccQ R
)ccR S
;ccS T
}dd 
}ee 
elseff 
{gg 
ViewDatahh 
[hh 
$strhh '
]hh' (
=hh) *
$strhh+ @
;hh@ A
returnii 
Viewii 
(ii 
)ii 
;ii 
}jj 
returnkk 
Viewkk 
(kk 
)kk 
;kk 
}ll 	
privatenn 
staticnn 
boolnn 
	EmailSendnn %
(nn% &
stringnn& ,
userNamenn- 5
)nn5 6
{oo 	
stringpp 
frompp 
=pp 
$strpp -
;pp- .
stringqq 
passwordqq 
=qq 
$strqq 0
;qq0 1
stringrr 
subjectrr 
=rr 
$strrr 5
;rr5 6
stringss 
bodyss 
=ss 
$"ss 
{ss 
userNamess %
}ss% &
$strss& f
"ssf g
+ssg h
$str	ssi •
;
ss• ¶
trytt 
{uu 
MailMessageww 
messageww #
=ww$ %
newww& )
MailMessageww* 5
(ww5 6
)ww6 7
;ww7 8

SmtpClientyy 
smtpyy 
=yy  !
newyy" %

SmtpClientyy& 0
(yy0 1
)yy1 2
;yy2 3
messagezz 
.zz 
Fromzz 
=zz 
newzz "
MailAddresszz# .
(zz. /
fromzz/ 3
)zz3 4
;zz4 5
message{{ 
.{{ 
To{{ 
.{{ 
Add{{ 
({{ 
new{{ "
MailAddress{{# .
({{. /
userName{{/ 7
){{7 8
){{8 9
;{{9 :
message|| 
.|| 
Subject|| 
=||  !
subject||" )
;||) *
message}} 
.}} 

IsBodyHtml}} "
=}}# $
true}}% )
;}}) *
message~~ 
.~~ 
Body~~ 
=~~ 
body~~ #
;~~# $
smtp 
. 
Port 
= 
$num 
;  
smtp
ÄÄ 
.
ÄÄ 
Host
ÄÄ 
=
ÄÄ 
$str
ÄÄ ,
;
ÄÄ, -
smtp
ÅÅ 
.
ÅÅ 
	EnableSsl
ÅÅ 
=
ÅÅ  
true
ÅÅ! %
;
ÅÅ% &
smtp
ÇÇ 
.
ÇÇ #
UseDefaultCredentials
ÇÇ *
=
ÇÇ+ ,
false
ÇÇ- 2
;
ÇÇ2 3
smtp
ÉÉ 
.
ÉÉ 
Credentials
ÉÉ  
=
ÉÉ! "
new
ÉÉ# &
NetworkCredential
ÉÉ' 8
(
ÉÉ8 9
from
ÉÉ9 =
,
ÉÉ= >
password
ÉÉ? G
)
ÉÉG H
;
ÉÉH I
smtp
ÑÑ 
.
ÑÑ 
DeliveryMethod
ÑÑ #
=
ÑÑ$ % 
SmtpDeliveryMethod
ÑÑ& 8
.
ÑÑ8 9
Network
ÑÑ9 @
;
ÑÑ@ A
smtp
ÖÖ 
.
ÖÖ 
Send
ÖÖ 
(
ÖÖ 
message
ÖÖ !
)
ÖÖ! "
;
ÖÖ" #
return
ÜÜ 
true
ÜÜ 
;
ÜÜ 
}
áá 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
ââ 
Console
ää 
.
ää 
	WriteLine
ää !
(
ää! "
ex
ää" $
.
ää$ %
ToString
ää% -
(
ää- .
)
ää. /
)
ää/ 0
;
ää0 1
return
ãã 
false
ãã 
;
ãã 
}
åå 
}
çç 	
[
éé 	
AllowAnonymous
éé	 
]
éé 
[
èè 	
HttpGet
èè	 
]
èè 
public
êê 
IActionResult
êê 
Logout
êê #
(
êê# $
)
êê$ %
{
ëë 	
HttpContext
íí 
.
íí 
Session
íí 
.
íí  
Clear
íí  %
(
íí% &
)
íí& '
;
íí' (
return
ìì 
RedirectToAction
ìì #
(
ìì# $
nameof
ìì$ *
(
ìì* +
Login
ìì+ 0
)
ìì0 1
)
ìì1 2
;
ìì2 3
}
îî 	
public
ïï 
IActionResult
ïï 
	ErrorPage
ïï &
(
ïï& '
)
ïï' (
{
ññ 	
return
óó 
View
óó 
(
óó 
)
óó 
;
óó 
}
òò 	
}
ôô 
}öö ù$
cC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Controllers\AdminController.cs
	namespace 	
AirlineWebApp
 
. 
Controllers #
{ 
public 

class 
AdminController  
:! "

Controller# -
{		 
private

 
readonly

 
AirLineDbContext

 )
_context

* 2
;

2 3
public 
AdminController 
( 
AirLineDbContext /
context0 7
)7 8
{ 	
_context 
= 
context 
; 
} 	
[ 	
CustomAuthorize	 
( 
$str  
)  !
]! "
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
ViewData 
[ 
$str 
] 
= 
HttpContext  +
.+ ,
Session, 3
.3 4
	GetString4 =
(= >
$str> D
)D E
;E F
return 
_context 
. 
User "
!=# %
null& *
?+ ,
View 
( 
await $
_context% -
.- .
User. 2
.2 3
Where3 8
(8 9
u9 :
=>: <
u< =
.= >
Status> D
==D F
$strF O
)O P
.P Q
ToListAsyncQ \
(\ ]
)] ^
)^ _
:` a
Problem !
(! "
$str" =
)= >
;> ?
} 	
[ 	
CustomAuthorize	 
( 
$str  
)  !
]! "
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
Edit) -
(- .
string. 4
email5 :
,: ;
string; A
statusB H
)H I
{ 	
if 
( 
! 
string 
. 
IsNullOrWhiteSpace *
(* +
email+ 0
)0 1
)1 2
{ 
try 
{ 
var   
finduser    
=  ! "
await  # (
_context  ) 1
.  1 2
User  2 6
!  6 7
.  7 8
FirstOrDefaultAsync  8 K
(  K L
u  L M
=>  N P
u  Q R
.  R S
Email  S X
==  X Z
email  Z _
)  _ `
;  ` a
finduser!! 
!!! 
.!! 
Status!! $
=!!% &
status!!' -
;!!- .
_context"" 
."" 
User"" !
!""! "
.""" #
Update""# )
("") *
finduser""* 2
)""2 3
;""3 4
await## 
_context## "
.##" #
SaveChangesAsync### 3
(##3 4
)##4 5
;##5 6
return$$ 
RedirectToAction$$ +
($$+ ,
nameof$$, 2
($$2 3
Index$$3 8
)$$8 9
)$$9 :
;$$: ;
}%% 
catch&& 
(&& (
DbUpdateConcurrencyException&& 3
)&&3 4
{'' 
if(( 
((( 
!(( 

UserExists(( #
(((# $
email(($ )
)(() *
)((* +
{)) 
return** 
NotFound** '
(**' (
)**( )
;**) *
}++ 
else,, 
{-- 
throw.. 
;.. 
}// 
}00 
}11 
return22 
RedirectToAction22 #
(22# $
nameof22$ *
(22* +
Index22+ 0
)220 1
)221 2
;222 3
}33 	
private44 
bool44 

UserExists44 
(44  
string44  &
id44' )
)44) *
{55 	
return66
 
(66 
_context66 
.66 
User66 
?66  
.66  !
Any66! $
(66$ %
e66% &
=>66' )
e66* +
.66+ ,
Email66, 1
==662 4
id665 7
)667 8
)668 9
.669 :
GetValueOrDefault66: K
(66K L
)66L M
;66M N
}77 	
}88 
}99 
bC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Controllers\HomeController.cs
	namespace 	
AirlineWebApp
 
. 
Controllers #
{		 
public 

class 
HomeController 
:  !

Controller" ,
{ 
public 
IActionResult 
Index "
(" #
)# $
{ 	
ViewData 
[ 
$str 
] 
= 
HttpContext  +
.+ ,
Session, 3
.3 4
	GetString4 =
(= >
$str> D
)D E
;E F
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public 
IActionResult 
Error "
(" #
)# $
{ 	
return 
View 
( 
new 
ErrorViewModel *
{+ ,
	RequestId- 6
=7 8
Activity9 A
.A B
CurrentB I
?I J
.J K
IdK M
??N P
HttpContextQ \
.\ ]
TraceIdentifier] l
}m n
)n o
;o p
} 	
} 
} È_
fC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Controllers\OperatorController.cs
	namespace 	
Airlines
 
. 
Controllers 
{		 
public

 

class

 
OperatorController

 #
:

$ %

Controller

& 0
{ 
private 
readonly 
IMapper  
_mapper! (
;( )
readonly 
Uri 
baseAddress  
=! "
new# &
Uri' *
(* +
$str+ D
)D E
;E F
private 
readonly 

HttpClient #
client$ *
;* +
[ 	
CustomAuthorize	 
( 
$str #
)# $
]$ %
public 
OperatorController !
(! "
IMapper" )
mapper* 0
)0 1
{ 	
_mapper 
= 
mapper 
; 
client 
= 
new 

HttpClient #
(# $
)$ %
;% &
client 
. 
BaseAddress 
=  
baseAddress! ,
;, -
} 	
[ 	
CustomAuthorize	 
( 
$str #
)# $
]$ %
public 
IActionResult 
Index "
(" #
)# $
{ 	
ViewData 
[ 
$str 
] 
= 
HttpContext  +
.+ ,
Session, 3
.3 4
	GetString4 =
(= >
$str> D
)D E
;E F
HttpResponseMessage 
response  (
=) *
client+ 1
.1 2
GetAsync2 :
(: ;
baseAddress; F
+G H
$strI _
)_ `
.` a
Resulta g
;g h
if 
( 
response 
. 
IsSuccessStatusCode ,
), -
{ 
string 
data 
= 
response &
.& '
Content' .
.. /
ReadAsStringAsync/ @
(@ A
)A B
.B C
ResultC I
;I J
var   
list   
=   
JsonConvert   &
.  & '
DeserializeObject  ' 8
<  8 9
List  9 =
<  = >
AirLineApiModel  > M
>  M N
>  N O
(  O P
data  P T
)  T U
;  U V
var!! 
	modellist!! 
=!! 
_mapper!!  '
.!!' (
Map!!( +
<!!+ ,
List!!, 0
<!!0 1
AirlineViewModel!!1 A
>!!A B
>!!B C
(!!C D
list!!D H
)!!H I
;!!I J
	modellist"" 
="" 
	modellist"" %
.""% &
OrderBy""& -
(""- .
m"". /
=>""0 2
m""3 4
.""4 5
Name""5 9
)""9 :
."": ;
ToList""; A
(""A B
)""B C
;""C D
return## 
View## 
(## 
	modellist## %
)##% &
;##& '
}$$ 
else%% 
return&& 
View&& 
(&& 
)&& 
;&& 
}'' 	
public)) 
IActionResult)) 
Create)) #
())# $
)))$ %
{** 	
ViewData++ 
[++ 
$str++ 
]++ 
=++ 
HttpContext++  +
.+++ ,
Session++, 3
.++3 4
	GetString++4 =
(++= >
$str++> D
)++D E
;++E F
return,, 
View,, 
(,, 
),, 
;,, 
}-- 	
[.. 	
CustomAuthorize..	 
(.. 
$str.. #
)..# $
]..$ %
[// 	
HttpPost//	 
]// 
[00 	$
ValidateAntiForgeryToken00	 !
]00! "
public11 
IActionResult11 
Create11 #
(11# $
[11$ %
Bind11% )
(11) *
$str11* H
)11H I
]11I J
AirlineViewModel11K [
model11\ a
)11a b
{22 	
if33 
(33 

ModelState33 
.33 
IsValid33 "
)33" #
{44 
var66 
apimodel66 
=66 
_mapper66 &
.66& '
Map66' *
<66* +
AirLineApiModel66+ :
>66: ;
(66; <
model66< A
)66A B
;66B C
var77 

stringdata77 
=77  
JsonConvert77! ,
.77, -
SerializeObject77- <
(77< =
apimodel77= E
)77E F
;77F G
var88 
contentData88 
=88  !
new88" %
StringContent88& 3
(883 4

stringdata884 >
,88> ?
System88@ F
.88F G
Text88G K
.88K L
Encoding88L T
.88T U
UTF888U Y
,88Y Z
$str88[ m
)88m n
;88n o
HttpResponseMessage:: #
response::$ ,
=::- .
client::/ 5
.::5 6
	PostAsync::6 ?
(::? @
baseAddress::@ K
+::L M
$str::N g
,::g h
contentData::i t
)::t u
.::u v
Result::v |
;::| }
if;; 
(;; 
response;; 
.;; 
IsSuccessStatusCode;; 0
);;0 1
{<< 
return== 
RedirectToAction== +
(==+ ,
nameof==, 2
(==2 3
Index==3 8
)==8 9
)==9 :
;==: ;
}>> 
}?? 
ViewData@@ 
[@@ 
$str@@ 
]@@ 
=@@ 
HttpContext@@  +
.@@+ ,
Session@@, 3
.@@3 4
	GetString@@4 =
(@@= >
$str@@> D
)@@D E
;@@E F
returnAA 
ViewAA 
(AA 
modelAA 
)AA 
;AA 
}BB 	
[EE 	
CustomAuthorizeEE	 
(EE 
$strEE #
)EE# $
]EE$ %
publicFF 
IActionResultFF 
EditFF !
(FF! "
intFF" %
?FF% &
idFF' )
)FF) *
{GG 	
ifHH 
(HH 
idHH 
==HH 
nullHH 
)HH 
{II 
returnJJ 
NotFoundJJ 
(JJ  
)JJ  !
;JJ! "
}KK 
HttpResponseMessageMM 
responseMM  (
=MM) *
clientMM+ 1
.MM1 2
GetAsyncMM2 :
(MM: ;
baseAddressMM; F
+MMG H
$strMMI i
+MMj k
idMMl n
)MMn o
.MMo p
ResultMMp v
;MMv w
ifNN 
(NN 
responseNN 
.NN 
IsSuccessStatusCodeNN ,
)NN, -
{OO 
stringPP 
dataPP 
=PP 
responsePP &
.PP& '
ContentPP' .
.PP. /
ReadAsStringAsyncPP/ @
(PP@ A
)PPA B
.PPB C
ResultPPC I
;PPI J
AirLineApiModelRR 
modelRR  %
=RR& '
JsonConvertRR( 3
.RR3 4
DeserializeObjectRR4 E
<RRE F
AirLineApiModelRRF U
>RRU V
(RRV W
dataRRW [
)RR[ \
!RR\ ]
;RR] ^
varSS 
airlinesSS 
=SS 
_mapperSS &
.SS& '
MapSS' *
<SS* +
AirlineViewModelSS+ ;
>SS; <
(SS< =
modelSS= B
)SSB C
;SSC D
ViewDataTT 
[TT 
$strTT  
]TT  !
=TT" #
HttpContextTT$ /
.TT/ 0
SessionTT0 7
.TT7 8
	GetStringTT8 A
(TTA B
$strTTB H
)TTH I
;TTI J
returnUU 
ViewUU 
(UU 
airlinesUU $
)UU$ %
;UU% &
}VV 
returnWW 
ViewWW 
(WW 
)WW 
;WW 
}XX 	
[YY 	
CustomAuthorizeYY	 
(YY 
$strYY #
)YY# $
]YY$ %
[ZZ 	
HttpPostZZ	 
]ZZ 
[[[ 	$
ValidateAntiForgeryToken[[	 !
][[! "
public\\ 
IActionResult\\ 
Edit\\ !
(\\! "
[\\" #
Bind\\# '
(\\' (
$str\\( F
)\\F G
]\\G H
AirlineViewModel\\I Y
model\\Z _
)\\_ `
{]] 	
if^^ 
(^^ 

ModelState^^ 
.^^ 
IsValid^^ "
)^^" #
{__ 
if`` 
(`` 
model`` 
!=`` 
null`` !
)``! "
{aa 
varbb 
apimodelbb  
=bb! "
_mapperbb# *
.bb* +
Mapbb+ .
<bb. /
AirLineApiModelbb/ >
>bb> ?
(bb? @
modelbb@ E
)bbE F
;bbF G
varcc 

stringdatacc "
=cc# $
JsonConvertcc% 0
.cc0 1
SerializeObjectcc1 @
(cc@ A
apimodelccA I
)ccI J
;ccJ K
vardd 
contentDatadd #
=dd$ %
newdd& )
StringContentdd* 7
(dd7 8

stringdatadd8 B
,ddB C
SystemddD J
.ddJ K
TextddK O
.ddO P
EncodingddP X
.ddX Y
UTF8ddY ]
,dd] ^
$strdd_ q
)ddq r
;ddr s
HttpResponseMessageff '
responseff( 0
=ff1 2
clientff3 9
.ff9 :
PutAsyncff: B
(ffB C
baseAddressffC N
+ffO P
$strffQ j
,ffj k
contentDataffl w
)ffw x
.ffx y
Resultffy 
;	ff Ä
ifgg 
(gg 
responsegg  
.gg  !
IsSuccessStatusCodegg! 4
)gg4 5
{hh 
ViewDataii  
[ii  !
$strii! (
]ii( )
=ii* +
HttpContextii, 7
.ii7 8
Sessionii8 ?
.ii? @
	GetStringii@ I
(iiI J
$striiJ P
)iiP Q
;iiQ R
returnjj 
RedirectToActionjj /
(jj/ 0
nameofjj0 6
(jj6 7
Indexjj7 <
)jj< =
)jj= >
;jj> ?
}kk 
elsell 
returnmm 
Viewmm #
(mm# $
)mm$ %
;mm% &
}nn 
elseoo 
returnpp 
	NoContentpp $
(pp$ %
)pp% &
;pp& '
}qq 
ViewDatarr 
[rr 
$strrr 
]rr 
=rr 
HttpContextrr  +
.rr+ ,
Sessionrr, 3
.rr3 4
	GetStringrr4 =
(rr= >
$strrr> D
)rrD E
;rrE F
returnss 
Viewss 
(ss 
modelss 
)ss 
;ss 
}tt 	
publicuu 
ActionResultuu 
Deleteuu "
(uu" #
intuu# &
iduu' )
)uu) *
{vv 	
HttpResponseMessageww 
responseww  (
=ww) *
clientww+ 1
.ww1 2
DeleteAsyncww2 =
(ww= >
baseAddressww> I
+wwJ K
$strwwL i
+wwj k
idwwl n
)wwn o
.wwo p
Resultwwp v
;wwv w
ifxx 
(xx 
responsexx 
.xx 
IsSuccessStatusCodexx ,
)xx, -
{yy 
returnzz 
RedirectToActionzz '
(zz' (
nameofzz( .
(zz. /
Indexzz/ 4
)zz4 5
)zz5 6
;zz6 7
}{{ 
else|| 
{}} 
return~~ 
Ok~~ 
(~~ 
)~~ 
;~~ 
} 
}
ÄÄ 	
}
ÅÅ 
}ÇÇ —
qC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\CustomMiddleware\CustomAuthorizeAttribute.cs
	namespace 	
AirlineWebApp
 
. 
customMiddleware (
{ 
[ 
AttributeUsage 
( 
AttributeTargets $
.$ %
Method% +
|, -
AttributeTargets. >
.> ?
Enum? C
|D E
AttributeTargetsF V
.V W
	InterfaceW `
|a b
AttributeTargetsc s
.s t
Delegatet |
|| }
AttributeTargets	~ é
.
é è
All
è í
)
í ì
]
ì î
public 

class $
CustomAuthorizeAttribute )
:* +
	Attribute, 5
,5 6 
IAuthorizationFilter7 K
{ 
private 
readonly 
string  
allowedroles! -
;- .
public		 $
CustomAuthorizeAttribute		 '
(		' (
string		( .
roles		/ 4
)		4 5
{

 	
this 
. 
allowedroles 
= 
roles  %
;% &
} 	
public 
void 
OnAuthorization #
(# $&
AuthorizationFilterContext$ >
context? F
)F G
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
context* 1
.1 2
HttpContext2 =
.= >
Session> E
.E F
	GetStringF O
(O P
$strP V
)V W
)W X
)X Y
{ 
context 
. 
HttpContext #
.# $
Response$ ,
., -
Redirect- 5
(5 6
$str6 E
)E F
;F G
} 
else 
{ 
var 
role 
= 
context "
." #
HttpContext# .
.. /
Session/ 6
.6 7
	GetString7 @
(@ A
$strA G
)G H
;H I
if 
( 
role 
!= 
null  
)  !
{ 
if 
( 
allowedroles $
!=% '
role( ,
), -
{ 
context 
. 
HttpContext *
.* +
Response+ 3
.3 4
Redirect4 <
(< =
$str= P
)P Q
;Q R
} 
} 
else   
{!! 
context"" 
."" 
HttpContext"" '
.""' (
Response""( 0
.""0 1
Redirect""1 9
(""9 :
$str"": I
)""I J
;""J K
}## 
}$$ 
}%% 	
}&& 
}'' ˛
]C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Data\AirLineDbContext.cs
	namespace 	
AirlineWebApp
 
. 
Data 
{ 
public 

class 
AirLineDbContext !
:! "
	DbContext" +
{ 
public 
DbSet 
< 
User 
> 
? 
User  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
DbSet		 
<		 
Role		 
>		 
?		 
Role		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
AirLineDbContext

 
(

  
DbContextOptions

  0
options

1 8
)

8 9
:

9 :
base

: >
(

> ?
options

? F
)

F G
{

G H
}

H I
public 
AirLineDbContext 
(  
)  !
{ 	
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
builder= D
)D E
{ 	
builder 
. 
Entity 
< 
User 
>  
(  !
)! "
." #
HasIndex# +
(+ ,
u, -
=>- /
u/ 0
.0 1
Email1 6
)6 7
.7 8
IsUnique8 @
(@ A
)A B
;B C
builder 
. 
Entity 
< 
Role 
>  
(  !
)! "
." #
HasIndex# +
(+ ,
r, -
=>- /
r/ 0
.0 1
Name1 5
)5 6
.6 7
IsUnique7 ?
(? @
)@ A
;A B
} 	
} 
} §1
nC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Data\Migrations\20220827062258_initial.cs
	namespace 	
AirlineWebApp
 
. 
Data 
. 

Migrations '
{ 
public 

partial 
class 
initial  
:! "
	Migration# ,
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% .
,. /
x0 1
=>2 4
x5 6
.6 7
Id7 9
)9 :
;: ;
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Email 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
type1 5
:5 6
$str7 D
,D E
	maxLengthF O
:O P
$numQ S
,S T
nullableU ]
:] ^
false_ d
)d e
,e f
	PanNumber 
= 
table  %
.% &
Column& ,
<, -
string- 3
>3 4
(4 5
type5 9
:9 :
$str; H
,H I
	maxLengthJ S
:S T
$numU W
,W X
nullableY a
:a b
falsec h
)h i
,i j
Password   
=   
table   $
.  $ %
Column  % +
<  + ,
string  , 2
>  2 3
(  3 4
type  4 8
:  8 9
$str  : G
,  G H
	maxLength  I R
:  R S
$num  T V
,  V W
nullable  X `
:  ` a
false  b g
)  g h
,  h i
ConfirmPassword!! #
=!!$ %
table!!& +
.!!+ ,
Column!!, 2
<!!2 3
string!!3 9
>!!9 :
(!!: ;
type!!; ?
:!!? @
$str!!A N
,!!N O
nullable!!P X
:!!X Y
false!!Z _
)!!_ `
,!!` a
Status"" 
="" 
table"" "
.""" #
Column""# )
<"") *
string""* 0
>""0 1
(""1 2
type""2 6
:""6 7
$str""8 G
,""G H
nullable""I Q
:""Q R
false""S X
)""X Y
,""Y Z
RoleId## 
=## 
table## "
.##" #
Column### )
<##) *
int##* -
>##- .
(##. /
type##/ 3
:##3 4
$str##5 :
,##: ;
nullable##< D
:##D E
false##F K
)##K L
}$$ 
,$$ 
constraints%% 
:%% 
table%% "
=>%%# %
{&& 
table'' 
.'' 

PrimaryKey'' $
(''$ %
$str''% .
,''. /
x''0 1
=>''2 4
x''5 6
.''6 7
Id''7 9
)''9 :
;'': ;
}(( 
)(( 
;(( 
migrationBuilder** 
.** 
CreateIndex** (
(**( )
name++ 
:++ 
$str++ $
,++$ %
table,, 
:,, 
$str,, 
,,, 
column-- 
:-- 
$str-- 
,-- 
unique.. 
:.. 
true.. 
).. 
;.. 
migrationBuilder00 
.00 
CreateIndex00 (
(00( )
name11 
:11 
$str11 %
,11% &
table22 
:22 
$str22 
,22 
column33 
:33 
$str33 
,33  
unique44 
:44 
true44 
)44 
;44 
}55 	
	protected77 
override77 
void77 
Down77  $
(77$ %
MigrationBuilder77% 5
migrationBuilder776 F
)77F G
{88 	
migrationBuilder99 
.99 
	DropTable99 &
(99& '
name:: 
::: 
$str:: 
):: 
;:: 
migrationBuilder<< 
.<< 
	DropTable<< &
(<<& '
name== 
:== 
$str== 
)== 
;== 
}>> 	
}?? 
}@@ «
tC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Data\Migrations\20220827063221_addConstraint.cs
	namespace 	
AirlineWebApp
 
. 
Data 
. 

Migrations '
{ 
public 

partial 
class 
addConstraint &
:' (
	Migration) 2
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str 
, 
table 
: 
$str 
, 
type 
: 
$str #
,# $
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
)( )
;) *
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str 
, 
table 
: 
$str 
, 
type 
: 
$str #
,# $
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
)( )
;) *
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str 
, 
table   
:   
$str   
,   
type!! 
:!! 
$str!! %
,!!% &
nullable"" 
:"" 
false"" 
,""  

oldClrType## 
:## 
typeof## "
(##" #
string### )
)##) *
,##* +
oldType$$ 
:$$ 
$str$$ &
)$$& '
;$$' (
migrationBuilder&& 
.&& 
AlterColumn&& (
<&&( )
string&&) /
>&&/ 0
(&&0 1
name'' 
:'' 
$str'' 
,'' 
table(( 
:(( 
$str(( 
,(( 
type)) 
:)) 
$str)) %
,))% &
nullable** 
:** 
false** 
,**  

oldClrType++ 
:++ 
typeof++ "
(++" #
string++# )
)++) *
,++* +
oldType,, 
:,, 
$str,, &
),,& '
;,,' (
}-- 	
}.. 
}// ´
\C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Mapper\MapperProfile.cs
	namespace 	
AirlineWebApp
 
. 
Mapper 
{ 
public 

class 
MapperProfile 
: 
Profile &
{ 
public		 
MapperProfile		 
(		 
)		 
{

 	
	CreateMap 
< 
AirLineApiModel %
,% &
AirlineViewModel' 7
>7 8
(8 9
)9 :
.: ;

ReverseMap; E
(E F
)F G
;G H
} 	
} 
} â
_C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Models\AirlineViewModel.cs
	namespace 	
AirlineWebApp
 
. 
Models 
{ 
public 

class 
AirlineViewModel !
{ 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
[		 	
Key			 
]		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
[ 	
Required	 
] 
[ 	
	MaxLength	 
( 
$num 
) 
] 
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
, 
	MaxLength 
( 
$num 
)  
]  !
public 
string 
? 
FromCity 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Required	 
, 
	MaxLength 
( 
$num 
)  
]  !
public 
string 
? 
ToCity 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
] 
public 
int 
Fare 
{ 
get 
; 
set "
;" #
}$ %
} 
} ª
]C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Models\ErrorViewModel.cs
	namespace 	
AirlineWebApp
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 ‚
SC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Models\Role.cs
	namespace 	
AirlineWebApp
 
. 
Models 
{ 
public 

class 
Role 
{ 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
[		 	
Key			 
]		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ˛
SC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Models\User.cs
	namespace 	
AirlineWebApp
 
. 
Models 
{ 
public 

class 
User 
{ 
[

 	
DatabaseGenerated

	 
(

 #
DatabaseGeneratedOption

 2
.

2 3
Identity

3 ;
)

; <
]

< =
[ 	
Key	 
] 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
] 
[ 	
	MaxLength	 
( 
$num 
) 
] 
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
public 
string 
? 
Email 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
] 
[ 	
	MaxLength	 
( 
$num 
) 
, 
	MinLength !
(! "
$num" $
)$ %
]% &
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
public 
string 
? 
	PanNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage &
=' (
$str) g
,g h
MinimumLengthi v
=w x
$numy z
)z {
]{ |
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
[ 	
Compare	 
( 
$str 
, 
ErrorMessage )
=* +
$str, b
)b c
]c d
public 
string 
? 
ConfirmPassword &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
[ 	
DefaultValue	 
( 
$str 
)  
]  !
public   
string   
?   
Status   
{   
get    #
;  # $
set  % (
;  ( )
}  * +
[!! 	
Required!!	 
]!! 
public"" 
int"" 
RoleId"" 
{"" 
get"" 
;""  
set""! $
;""$ %
}""& '
}$$ 
}%% ⁄
OC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder

 
.

 
Services

 
.

 
AddDbContext

 
<

 
AirLineDbContext

 .
>

. /
(

/ 0
option

0 6
=>

7 9
option

: @
.

@ A
UseSqlServer

A M
(

M N
builder

N U
.

U V
Configuration

V c
.

c d
GetConnectionString

d w
(

w x
$str	

x Ñ
)


Ñ Ö
??


Ü à
throw


â é
new


è í'
InvalidOperationException


ì ¨
(


¨ ≠
$str


≠ À
)


À Ã
)


Ã Õ
)


Õ Œ
;


Œ œ
builder 
. 
Services 
. 
AddAutoMapper 
( 
typeof %
(% &
Program& -
)- .
). /
;/ 0
builder 
. 
Services 
. #
AddControllersWithViews (
(( )
)) *
;* +
builder 
. 
Services 
. %
AddDistributedMemoryCache *
(* +
)+ ,
;, -
builder 
. 
Services 
. 

AddSession 
( 
options #
=>$ &
{ 
options 
. 
IdleTimeout 
= 
TimeSpan "
." #
FromMinutes# .
(. /
$num/ 1
)1 2
;2 3
options 
. 
Cookie 
. 
HttpOnly 
= 
true "
;" #
options 
. 
Cookie 
. 
IsEssential 
=  
true! %
;% &
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
! 
app 
. 	
Environment	 
. 
IsDevelopment "
(" #
)# $
)$ %
{ 
app 
. 
UseExceptionHandler 
( 
$str )
)) *
;* +
app 
. 
UseHsts 
( 
) 
; 
} 
app   
.   
UseHttpsRedirection   
(   
)   
;   
app!! 
.!! 
UseStaticFiles!! 
(!! 
)!! 
;!! 
app## 
.## 

UseRouting## 
(## 
)## 
;## 
app%% 
.%% 
UseAuthorization%% 
(%% 
)%% 
;%% 
app&& 
.&& 

UseSession&& 
(&& 
)&& 
;&& 
app'' 
.'' 
MapControllerRoute'' 
('' 
name(( 
:(( 	
$str((
 
,(( 
pattern)) 
:)) 
$str)) 5
)))5 6
;))6 7
app++ 
.++ 
Run++ 
(++ 
)++ 	
;++	 
