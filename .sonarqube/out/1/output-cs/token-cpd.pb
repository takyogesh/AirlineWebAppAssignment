Ñ
`C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\ApiModel\AirLineApiModel.cs
	namespace 	
AirLines
 
. 
ApiModel 
{ 
public 

class 
AirLineApiModel  
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
FromCity 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
string		 
?		 
ToCity		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public

 
int

 
Fare

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
} 
} òk
eC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Controllers\AccountController.cs
	namespace		 	
AirLines		
 
.		 
Controllers		 
{

 
public 

class 
AccountController "
:# $

Controller% /
{ 
private 
readonly 
AirLineDbContext )
_context* 2
;2 3
public 
AccountController  
(  !
AirLineDbContext! 1
context2 9
)9 :
{ 	
_context 
= 
context 
; 
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
HttpContext& 1
.1 2
Session2 9
.9 :
	GetString: C
(C D
$strD J
)J K
)K L
)L M
{ 
return 
RedirectToAction '
(' (
$str( /
,/ 0
$str1 7
)7 8
;8 9
} 
else 
{ 
return 
View 
( 
) 
; 
} 
} 	
[ 	
HttpPost	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
IsEmailExsist) 6
(6 7
string7 =
email> C
)C D
{ 	
if   
(   
!   
string   
.   
IsNullOrEmpty   %
(  % &
email  & +
)  + ,
)  , -
{!! 
var"" 
finduser""  
=""! "
await""# (
_context"") 1
.""1 2
User""2 6
!""6 7
.""7 8
FirstOrDefaultAsync""8 K
(""K L
x""L M
=>""N P
x""Q R
.""R S
Email""S X
==""Y [
email""\ a
)""a b
;""b c
if## 
(## 
finduser##  
!=##! #
null##$ (
)##( )
{$$ 
return%% 
Ok%% !
(%%! "
$str%%" )
)%%) *
;%%* +
}&& 
}'' 
return(( 
Ok(( 
((( 
$str((  
)((  !
;((! "
})) 	
[** 	
HttpPost**	 
]** 
public++ 
IActionResult++ 
Create++ #
(++# $
User++$ (
user++) -
)++- .
{,, 	
var-- 
Isemail-- 
=-- 
_context-- !
.--! "
User--" &
!--& '
.--' (
FirstOrDefault--( 6
(--6 7
u--7 8
=>--8 :
u--: ;
.--; <
Email--< A
==--A C
user--C G
.--G H
Email--H M
)--M N
;--N O
if.. 
(.. 
Isemail.. 
!=.. 
null.. 
).. 
{// 
return00 
RedirectToAction00 '
(00' (
nameof00( .
(00. /
Index00/ 4
)004 5
)005 6
;006 7
}11 
else22 
{33 
_context44 
.44 
User44 
!44 
.44 
Add44 "
(44" #
user44# '
)44' (
;44( )
_context55 
.55 
SaveChanges55 $
(55$ %
)55% &
;55& '
var66 
role66 
=66 
_context66 #
.66# $
Role66$ (
!66( )
.66) *
FirstOrDefault66* 8
(668 9
r669 :
=>66; =
r66> ?
.66? @
Id66@ B
==66C E
user66F J
.66J K
RoleId66K Q
)66Q R
;66R S
if77 
(77 
role77 
!=77 
null77  
)77  !
{88 
bool99 
send99 
=99 
	EmailSend99 '
(99' (
user99( ,
.99, -
Email99- 2
!992 3
)993 4
;994 5
if:: 
(:: 
role:: 
.:: 
Name:: !
==::" $
$str::% ,
)::, -
{;; 
return<< 
RedirectToAction<< /
(<</ 0
$str<<0 7
)<<7 8
;<<8 9
}== 
else>> 
if>> 
(>> 
role>> !
.>>! "
Name>>" &
==>>' )
$str>>* 4
)>>4 5
{?? 
return@@ 
RedirectToAction@@ /
(@@/ 0
$str@@0 7
)@@7 8
;@@8 9
}AA 
}BB 
returnCC 
RedirectToActionCC '
(CC' (
nameofCC( .
(CC. /
IndexCC/ 4
)CC4 5
)CC5 6
;CC6 7
}DD 
}FF 	
[GG 	
HttpPostGG	 
]GG 
publicHH 
asyncHH 
TaskHH 
<HH 
IActionResultHH '
>HH' (
LoginHH) .
(HH. /
stringHH/ 5
EmailHH6 ;
,HH; <
stringHH< B
passwordHHC K
)HHK L
{II 	
varJJ 
IsuserJJ 
=JJ 
awaitJJ 
_contextJJ %
.JJ% &
UserJJ& *
!JJ* +
.JJ+ ,
FirstOrDefaultAsyncJJ, ?
(JJ? @
uJJ@ A
=>JJA C
uJJC D
.JJD E
EmailJJE J
==JJJ L
EmailJJL Q
&&JJR T
uJJU V
.JJV W
PasswordJJW _
==JJ_ a
passwordJJa i
)JJi j
;JJj k
ifKK 
(KK 
IsuserKK 
!=KK 
nullKK 
&&KK !
IsuserKK" (
.KK( )
StatusKK) /
!=KK/ 1
$strKK1 :
&&KK; =
IsuserKK> D
.KKD E
StatusKKE K
!=KKK M
$strKKM U
)KKU V
{LL 
HttpContextMM 
.MM 
SessionMM #
.MM# $
	SetStringMM$ -
(MM- .
$strMM. 4
,MM4 5
IsuserMM6 <
.MM< =
EmailMM= B
!MMB C
)MMC D
;MMD E
varNN 
rolNN 
=NN 
_contextNN  
.NN  !
RoleNN! %
!NN% &
.NN& '

FirstAsyncNN' 1
(NN1 2
rNN2 3
=>NN4 6
rNN7 8
.NN8 9
IdNN9 ;
==NN; =
IsuserNN= C
.NNC D
RoleIdNND J
)NNJ K
.NNK L
ResultNNL R
;NNR S
HttpContextOO 
.OO 
SessionOO #
.OO# $
SetInt32OO$ ,
(OO, -
$strOO- 5
,OO5 6
IsuserOO7 =
.OO= >
RoleIdOO> D
)OOD E
;OOE F
HttpContextPP 
.PP 
SessionPP #
.PP# $
	SetStringPP$ -
(PP- .
$strPP. 4
,PP4 5
rolPP6 9
.PP9 :
NamePP: >
!PP> ?
)PP? @
;PP@ A
varQQ 
roleQQ 
=QQ 
awaitQQ 
_contextQQ  (
.QQ( )
RoleQQ) -
!QQ- .
.QQ. /
FirstOrDefaultAsyncQQ/ B
(QQB C
rQQC D
=>QQE G
rQQH I
.QQI J
IdQQJ L
==QQM O
IsuserQQP V
.QQV W
RoleIdQQW ]
)QQ] ^
;QQ^ _
ifRR 
(RR 
roleRR 
!RR 
.RR 
NameRR 
==RR !
$strRR" )
)RR) *
{SS 
returnTT 
RedirectToActionTT +
(TT+ ,
$strTT, 3
,TT3 4
$strTT5 ;
,TT; <
newTT= @
{TTA B
areaTTC G
=TTH I
$strTTJ P
}TTQ R
)TTR S
;TTS T
}UU 
elseVV 
ifVV 
(VV 
roleVV 
!VV 
.VV 
NameVV "
==VV# %
$strVV& 0
)VV0 1
{WW 
returnXX 
RedirectToActionXX +
(XX+ ,
$strXX, 3
,XX3 4
$strXX5 ;
,XX; <
newXX= @
{XXA B
areaXXC G
=XXH I
$strXXJ P
}XXQ R
)XXR S
;XXS T
}YY 
}ZZ 
else[[ 
{\\ 
ViewData]] 
[]] 
$str]] '
]]]' (
=]]) *
$str]]+ @
;]]@ A
return^^ 
View^^ 
(^^ 
)^^ 
;^^ 
}__ 
return`` 
View`` 
(`` 
)`` 
;`` 
}aa 	
[bb 	
HttpGetbb	 
]bb 
publiccc 
IActionResultcc 
Logincc "
(cc" #
)cc# $
{dd 	
ifee 
(ee 
!ee 
stringee 
.ee 
IsNullOrEmptyee %
(ee% &
HttpContextee& 1
.ee1 2
Sessionee2 9
.ee9 :
	GetStringee: C
(eeC D
$streeD J
)eeJ K
)eeK L
)eeL M
{ff 
returngg 
RedirectToActiongg '
(gg' (
$strgg( /
,gg/ 0
$strgg1 7
)gg7 8
;gg8 9
}hh 
elseii 
{jj 
returnkk 
Viewkk 
(kk 
)kk 
;kk 
}ll 
}mm 	
privatenn 
staticnn 
boolnn 
	EmailSendnn %
(nn% &
stringnn& ,
usernamenn- 5
)nn5 6
{oo 	
stringpp 
frompp 
=pp 
$strpp -
;pp- .
stringqq 
passwordqq 
=qq 
$strqq 0
;qq0 1
stringrr 
subjectrr 
=rr 
$strrr 5
;rr5 6
stringss 
bodyss 
=ss 
$"ss 
{ss 
usernamess %
}ss% &
$strss& f
"ssf g
+ssg h
$str	ssi ¥
;
ss¥ ¦
trytt 
{uu 
MailMessagevv 
messagevv #
=vv$ %
newvv& )
MailMessagevv* 5
(vv5 6
)vv6 7
;vv7 8

SmtpClientww 
smtpww 
=ww  !
newww" %

SmtpClientww& 0
(ww0 1
)ww1 2
;ww2 3
messagexx 
.xx 
Fromxx 
=xx 
newxx "
MailAddressxx# .
(xx. /
fromxx/ 3
)xx3 4
;xx4 5
messageyy 
.yy 
Toyy 
.yy 
Addyy 
(yy 
newyy "
MailAddressyy# .
(yy. /
usernameyy/ 7
)yy7 8
)yy8 9
;yy9 :
messagezz 
.zz 
Subjectzz 
=zz  !
subjectzz" )
;zz) *
message{{ 
.{{ 

IsBodyHtml{{ "
={{# $
true{{% )
;{{) *
message|| 
.|| 
Body|| 
=|| 
body|| #
;||# $
smtp}} 
.}} 
Port}} 
=}} 
$num}} 
;}}  
smtp~~ 
.~~ 
Host~~ 
=~~ 
$str~~ ,
;~~, -
smtp 
. 
	EnableSsl 
=  
true! %
;% &
smtp
 
.
 #
UseDefaultCredentials
 *
=
+ ,
false
- 2
;
2 3
smtp
 
.
 
Credentials
  
=
! "
new
# &
NetworkCredential
' 8
(
8 9
from
9 =
,
= >
password
? G
)
G H
;
H I
smtp
 
.
 
DeliveryMethod
 #
=
$ % 
SmtpDeliveryMethod
& 8
.
8 9
Network
9 @
;
@ A
smtp
 
.
 
Send
 
(
 
message
 !
)
! "
;
" #
return
 
true
 
;
 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
Console
 
.
 
	WriteLine
 !
(
! "
ex
" $
.
$ %
ToString
% -
(
- .
)
. /
)
/ 0
;
0 1
return
 
false
 
;
 
}
 
}
 	
[
 	
AllowAnonymous
	 
]
 
[
 	
HttpGet
	 
]
 
public
 
IActionResult
 
Logout
 #
(
# $
)
$ %
{
 	
HttpContext
 
.
 
Session
 
.
  
Clear
  %
(
% &
)
& '
;
' (
return
 
RedirectToAction
 #
(
# $
nameof
$ *
(
* +
Login
+ 0
)
0 1
)
1 2
;
2 3
}
 	
public
 
IActionResult
 
	ErrorPage
 &
(
& '
)
' (
{
 	
return
 
View
 
(
 
)
 
;
 
}
 	
}
 
} $
cC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Controllers\AdminController.cs
	namespace 	
AirLines
 
. 
Controllers 
{ 
public 

class 
AdminController  
:! "

Controller# -
{ 
private 
readonly 
AirLineDbContext )
_context* 2
;2 3
public 
AdminController 
( 
AirLineDbContext /
context0 7
)7 8
{ 	
_context 
= 
context 
; 
} 	
[ 	
CustomAuthorize	 
( 
$str  
)  !
]! "
public 
async 
Task 
< 
IActionResult '
>' (
Index) .
(. /
)/ 0
{ 	
ViewData 
[ 
$str 
]  
=! "
HttpContext# .
.. /
Session/ 6
.6 7
	GetString7 @
(@ A
$strA G
)G H
;H I
return 
_context 
. 
User "
!=# %
null& *
?+ ,
View   
(   
await   $
_context  % -
.  - .
User  . 2
.  2 3
Where  3 8
(  8 9
u  9 :
=>  : <
u  < =
.  = >
Status  > D
==  D F
$str  F O
)  O P
.  P Q
ToListAsync  Q \
(  \ ]
)  ] ^
)  ^ _
:  ` a
Problem!! !
(!!! "
$str!!" O
)!!O P
;!!P Q
}"" 	
[## 	
CustomAuthorize##	 
(## 
$str##  
)##  !
]##! "
[$$ 	
HttpPost$$	 
]$$ 
public%% 
async%% 
Task%% 
<%% 
IActionResult%% '
>%%' (
Edit%%) -
(%%- .
string%%. 4
email%%5 :
,%%: ;
string%%; A
status%%B H
)%%H I
{&& 	
if)) 
()) 
!)) 
string)) 
.)) 
IsNullOrWhiteSpace)) *
())* +
email))+ 0
)))0 1
)))1 2
{** 
try++ 
{,, 
var-- 
finduser--  
=--! "
await--# (
_context--) 1
.--1 2
User--2 6
!--6 7
.--7 8
FirstOrDefaultAsync--8 K
(--K L
u--L M
=>--N P
u--Q R
.--R S
Email--S X
==--X Z
email--Z _
)--_ `
;--` a
finduser.. 
!.. 
... 
Status.. $
=..% &
status..' -
;..- .
_context// 
.// 
User// !
!//! "
.//" #
Update//# )
(//) *
finduser//* 2
)//2 3
;//3 4
await00 
_context00 !
.00! "
SaveChangesAsync00" 2
(002 3
)003 4
;004 5
return11 
RedirectToAction11 +
(11+ ,
nameof11, 2
(112 3
Index113 8
)118 9
)119 :
;11: ;
}22 
catch33 
(33 (
DbUpdateConcurrencyException33 3
)333 4
{44 
if55 
(55 
!55 

UserExists55 #
(55# $
email55$ )
)55) *
)55* +
{66 
return77 
NotFound77 '
(77' (
)77( )
;77) *
}88 
else99 
{:: 
throw;; 
;;; 
}<< 
}== 
}?? 
return@@ 
RedirectToAction@@ #
(@@# $
nameof@@$ *
(@@* +
Index@@+ 0
)@@0 1
)@@1 2
;@@2 3
}AA 	
privateCC 
boolCC 

UserExistsCC 
(CC  
stringCC  &
idCC' )
)CC) *
{DD 	
returnEE
 
(EE 
_contextEE 
.EE 
UserEE 
?EE  
.EE  !
AnyEE! $
(EE$ %
eEE% &
=>EE' )
eEE* +
.EE+ ,
EmailEE, 1
==EE2 4
idEE5 7
)EE7 8
)EE8 9
.EE9 :
GetValueOrDefaultEE: K
(EEK L
)EEL M
;EEM N
}FF 	
}GG 
}HH ë
bC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Controllers\HomeController.cs
	namespace 	
AirLines
 
. 
Controllers 
{		 
public 

class 
HomeController 
:  !

Controller" ,
{ 
public 
IActionResult 
Index "
(" #
)# $
{ 	
ViewData 
[ 
$str 
]  
=! "
HttpContext# .
.. /
Session/ 6
.6 7
	GetString7 @
(@ A
$strA G
)G H
;H I
return 
View 
( 
) 
; 
} 	
[ 	
ResponseCache	 
( 
Duration 
=  !
$num" #
,# $
Location% -
=. /!
ResponseCacheLocation0 E
.E F
NoneF J
,J K
NoStoreL S
=T U
trueV Z
)Z [
][ \
public 
IActionResult 
Error "
(" #
)# $
{ 	
return 
View 
( 
new 
ErrorViewModel *
{+ ,
	RequestId- 6
=7 8
Activity9 A
.A B
CurrentB I
?I J
.J K
IdK M
??N P
HttpContextQ \
.\ ]
TraceIdentifier] l
}m n
)n o
;o p
} 	
} 
} Îa
fC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Controllers\OperatorController.cs
	namespace 	
Airlines
 
. 
Controllers 
{		 
public

 

class

 
OperatorController

 #
:

$ %

Controller

& 0
{ 
private 
readonly 
IMapper  
_mapper! (
;( )
Uri 
baseAddress 
= 
new 
Uri !
(! "
$str" ;
); <
;< =
private 
readonly 

HttpClient #
client$ *
;* +
[ 	
CustomAuthorize	 
( 
$str #
)# $
]$ %
public 
OperatorController !
(! "
IMapper" )
mapper* 0
)0 1
{ 	
_mapper 
= 
mapper 
; 
client 
= 
new 

HttpClient #
(# $
)$ %
;% &
client 
. 
BaseAddress 
=  
baseAddress! ,
;, -
} 	
[ 	
CustomAuthorize	 
( 
$str #
)# $
]$ %
public 
IActionResult 
Index "
(" #
)# $
{ 	
ViewData 
[ 
$str 
]  
=! "
HttpContext# .
.. /
Session/ 6
.6 7
	GetString7 @
(@ A
$strA G
)G H
;H I
HttpResponseMessage 
response  (
=) *
client+ 1
.1 2
GetAsync2 :
(: ;
baseAddress; F
+G H
$strI _
)_ `
.` a
Resulta g
;g h
if 
( 
response 
. 
IsSuccessStatusCode ,
), -
{ 
string 
data 
= 
response &
.& '
Content' .
.. /
ReadAsStringAsync/ @
(@ A
)A B
.B C
ResultC I
;I J
var   
list   
=   
JsonConvert   &
.  & '
DeserializeObject  ' 8
<  8 9
List  9 =
<  = >
AirLineApiModel  > M
>  M N
>  N O
(  O P
data  P T
)  T U
;  U V
var!! 
	modellist!! 
=!! 
_mapper!!  '
.!!' (
Map!!( +
<!!+ ,
List!!, 0
<!!0 1
AirlineViewModel!!1 A
>!!A B
>!!B C
(!!C D
list!!D H
)!!H I
;!!I J
	modellist"" 
="" 
	modellist"" %
.""% &
OrderBy""& -
(""- .
m"". /
=>""0 2
m""3 4
.""4 5
Name""5 9
)""9 :
."": ;
ToList""; A
(""A B
)""B C
;""C D
return## 
View## 
(## 
	modellist## %
)##% &
;##& '
}$$ 
else%% 
return&& 
View&& 
(&& 
)&& 
;&& 
}'' 	
public)) 
IActionResult)) 
Create)) #
())# $
)))$ %
{** 	
ViewData++ 
[++ 
$str++ 
]++  
=++! "
HttpContext++# .
.++. /
Session++/ 6
.++6 7
	GetString++7 @
(++@ A
$str++A G
)++G H
;++H I
return,, 
View,, 
(,, 
),, 
;,, 
}-- 	
[.. 	
CustomAuthorize..	 
(.. 
$str.. #
)..# $
]..$ %
[// 	
HttpPost//	 
]// 
[00 	$
ValidateAntiForgeryToken00	 !
]00! "
public11 
IActionResult11 
Create11 #
(11# $
[11$ %
Bind11% )
(11) *
$str11* H
)11H I
]11I J
AirlineViewModel11K [
model11\ a
)11a b
{22 	
if33 
(33 

ModelState33 
.33 
IsValid33 "
)33" #
{44 
var66 
apimodel66 
=66 
_mapper66 &
.66& '
Map66' *
<66* +
AirLineApiModel66+ :
>66: ;
(66; <
model66< A
)66A B
;66B C
var77 

stringdata77 
=77  
JsonConvert77! ,
.77, -
SerializeObject77- <
(77< =
apimodel77= E
)77E F
;77F G
var88 
contentData88 
=88  !
new88" %
StringContent88& 3
(883 4

stringdata884 >
,88> ?
System88@ F
.88F G
Text88G K
.88K L
Encoding88L T
.88T U
UTF888U Y
,88Y Z
$str88[ m
)88m n
;88n o
HttpResponseMessage:: #
response::$ ,
=::- .
client::/ 5
.::5 6
	PostAsync::6 ?
(::? @
baseAddress::@ K
+::L M
$str::N g
,::g h
contentData::i t
)::t u
.::u v
Result::v |
;::| }
if;; 
(;; 
response;; 
.;; 
IsSuccessStatusCode;; 0
);;0 1
{<< 
return== 
RedirectToAction== +
(==+ ,
nameof==, 2
(==2 3
Index==3 8
)==8 9
)==9 :
;==: ;
}>> 
}?? 
ViewData@@ 
[@@ 
$str@@ 
]@@  
=@@! "
HttpContext@@# .
.@@. /
Session@@/ 6
.@@6 7
	GetString@@7 @
(@@@ A
$str@@A G
)@@G H
;@@H I
returnAA 
ViewAA 
(AA 
modelAA 
)AA 
;AA 
}BB 	
[EE 	
CustomAuthorizeEE	 
(EE 
$strEE #
)EE# $
]EE$ %
publicFF 
IActionResultFF 
EditFF !
(FF! "
intFF" %
?FF% &
idFF' )
)FF) *
{GG 	
ifHH 
(HH 
idHH 
==HH 
nullHH 
)HH 
{II 
returnJJ 
NotFoundJJ 
(JJ  
)JJ  !
;JJ! "
}KK 
HttpResponseMessageMM 
responseMM  (
=MM) *
clientMM+ 1
.MM1 2
GetAsyncMM2 :
(MM: ;
baseAddressMM; F
+MMG H
$strMMI i
+MMj k
idMMl n
)MMn o
.MMo p
ResultMMp v
;MMv w
ifNN 
(NN 
responseNN 
.NN 
IsSuccessStatusCodeNN ,
)NN, -
{OO 
stringPP 
dataPP 
=PP 
responsePP &
.PP& '
ContentPP' .
.PP. /
ReadAsStringAsyncPP/ @
(PP@ A
)PPA B
.PPB C
ResultPPC I
;PPI J
stringRR 

stringDataRR !
=RR" #
responseRR$ ,
.RR, -
ContentRR- 4
.RR4 5
ReadAsStringAsyncRR5 F
(RRF G
)RRG H
.RRH I
ResultRRI O
;RRO P
AirLineApiModelSS 
modelSS  %
=SS& '
JsonConvertSS( 3
.SS3 4
DeserializeObjectSS4 E
<SSE F
AirLineApiModelSSF U
>SSU V
(SSV W

stringDataSSW a
)SSa b
!SSb c
;SSc d
varTT 
airlinesTT 
=TT 
_mapperTT &
.TT& '
MapTT' *
<TT* +
AirlineViewModelTT+ ;
>TT; <
(TT< =
modelTT= B
)TTB C
;TTC D
ViewDataUU 
[UU 
$strUU #
]UU# $
=UU% &
HttpContextUU' 2
.UU2 3
SessionUU3 :
.UU: ;
	GetStringUU; D
(UUD E
$strUUE K
)UUK L
;UUL M
returnVV 
ViewVV 
(VV 
airlinesVV $
)VV$ %
;VV% &
}WW 
returnXX 
ViewXX 
(XX 
)XX 
;XX 
}YY 	
[ZZ 	
CustomAuthorizeZZ	 
(ZZ 
$strZZ #
)ZZ# $
]ZZ$ %
[[[ 	
HttpPost[[	 
][[ 
[\\ 	$
ValidateAntiForgeryToken\\	 !
]\\! "
public]] 
IActionResult]] 
Edit]] !
(]]! "
[]]" #
Bind]]# '
(]]' (
$str]]( F
)]]F G
]]]G H
AirlineViewModel]]I Y
model]]Z _
)]]_ `
{^^ 	
if__ 
(__ 

ModelState__ 
.__ 
IsValid__ "
)__" #
{`` 
ifaa 
(aa 
modelaa 
!=aa 
nullaa !
)aa! "
{bb 
varcc 
apimodelcc  
=cc! "
_mappercc# *
.cc* +
Mapcc+ .
<cc. /
AirLineApiModelcc/ >
>cc> ?
(cc? @
modelcc@ E
)ccE F
;ccF G
vardd 

stringdatadd "
=dd# $
JsonConvertdd% 0
.dd0 1
SerializeObjectdd1 @
(dd@ A
apimodelddA I
)ddI J
;ddJ K
varee 
contentDataee #
=ee$ %
newee& )
StringContentee* 7
(ee7 8

stringdataee8 B
,eeB C
SystemeeD J
.eeJ K
TexteeK O
.eeO P
EncodingeeP X
.eeX Y
UTF8eeY ]
,ee] ^
$stree_ q
)eeq r
;eer s
HttpResponseMessagegg '
responsegg( 0
=gg1 2
clientgg3 9
.gg9 :
PutAsyncgg: B
(ggB C
baseAddressggC N
+ggO P
$strggQ j
,ggj k
contentDataggl w
)ggw x
.ggx y
Resultggy 
;	gg 
ifhh 
(hh 
responsehh  
.hh  !
IsSuccessStatusCodehh! 4
)hh4 5
{ii 
ViewDatajj  
[jj  !
$strjj! +
]jj+ ,
=jj- .
HttpContextjj/ :
.jj: ;
Sessionjj; B
.jjB C
	GetStringjjC L
(jjL M
$strjjM S
)jjS T
;jjT U
returnkk 
RedirectToActionkk /
(kk/ 0
nameofkk0 6
(kk6 7
Indexkk7 <
)kk< =
)kk= >
;kk> ?
}ll 
elsemm 
returnnn 
Viewnn #
(nn# $
)nn$ %
;nn% &
}oo 
elsepp 
returnqq 
	NoContentqq $
(qq$ %
)qq% &
;qq& '
}rr 
ViewDatass 
[ss 
$strss 
]ss  
=ss! "
HttpContextss# .
.ss. /
Sessionss/ 6
.ss6 7
	GetStringss7 @
(ss@ A
$strssA G
)ssG H
;ssH I
returntt 
Viewtt 
(tt 
modeltt 
)tt 
;tt 
}uu 	
publicvv 
ActionResultvv 
Deletevv "
(vv" #
intvv# &
idvv' )
)vv) *
{ww 	
HttpResponseMessagexx 
responsexx  (
=xx) *
clientxx+ 1
.xx1 2
DeleteAsyncxx2 =
(xx= >
baseAddressxx> I
+xxJ K
$strxxL i
+xxj k
idxxl n
)xxn o
.xxo p
Resultxxp v
;xxv w
ifyy 
(yy 
responseyy 
.yy 
IsSuccessStatusCodeyy ,
)yy, -
{zz 
return{{ 
RedirectToAction{{ '
({{' (
nameof{{( .
({{. /
Index{{/ 4
){{4 5
){{5 6
;{{6 7
}|| 
else}} 
{~~ 
return 
Ok 
( 
) 
; 
}
 
}
 	
}
 
} ¾
qC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\customMiddleware\CustomAuthorizeAttribute.cs
	namespace 	
AirLines
 
. 
customMiddleware #
{ 
[ 
AttributeUsage 
( 
AttributeTargets $
.$ %
Method% +
|, -
AttributeTargets. >
.> ?
Enum? C
|D E
AttributeTargetsF V
.V W
	InterfaceW `
|a b
AttributeTargetsc s
.s t
Delegatet |
|| }
AttributeTargets	~ 
.
 
All
 
)
 
]
 
public 

class $
CustomAuthorizeAttribute )
:* +
	Attribute, 5
,5 6 
IAuthorizationFilter7 K
{		 
private

 
readonly

 
string

  
allowedroles

! -
;

- .
public $
CustomAuthorizeAttribute '
(' (
string( .
roles/ 4
)4 5
{ 	
this 
. 
allowedroles 
= 
roles  %
;% &
} 	
public 
void 
OnAuthorization #
(# $&
AuthorizationFilterContext$ >
httpcontext? J
)J K
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
httpcontext* 5
.5 6
HttpContext6 A
.A B
SessionB I
.I J
	GetStringJ S
(S T
$strT Z
)Z [
)[ \
)\ ]
{ 
httpcontext 
. 
HttpContext '
.' (
Response( 0
.0 1
Redirect1 9
(9 :
$str: I
)I J
;J K
} 
else 
{ 
var   
role   
=   
httpcontext   &
.  & '
HttpContext  ' 2
.  2 3
Session  3 :
.  : ;
	GetString  ; D
(  D E
$str  E K
)  K L
;  L M
if"" 
("" 
role"" 
!="" 
null""  
)""  !
{## 
if$$ 
($$ 
allowedroles$$ $
==$$% '
role$$( ,
)$$, -
{%% 
if&& 
(&& 
allowedroles&& (
==&&) +
$str&&, 3
&&&&4 6
role&&7 ;
==&&< >
$str&&? F
)&&F G
{'' 
}** 
else++ 
if++ 
(++  !
allowedroles++! -
==++. 0
$str++1 ;
&&++< >
role++? C
==++D F
$str++G Q
)++Q R
{,, 
}.. 
}// 
else00 
{11 
httpcontext22 #
.22# $
HttpContext22$ /
.22/ 0
Response220 8
.228 9
Redirect229 A
(22A B
$str22B U
)22U V
;22V W
}44 
}77 
else88 
{99 
httpcontext:: 
.::  
HttpContext::  +
.::+ ,
Response::, 4
.::4 5
Redirect::5 =
(::= >
$str::> M
)::M N
;::N O
};; 
}<< 
}?? 	
}@@ 
}AA ù
]C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Data\AirLineDbContext.cs
	namespace 	
AirLines
 
. 
Data 
{ 
public 

class 
AirLineDbContext !
:! "
	DbContext" +
{ 
public 
DbSet 
< 
User 
> 
? 
User  
{! "
get# &
;& '
set( +
;+ ,
}- .
public		 
DbSet		 
<		 
Role		 
>		 
?		 
Role		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
AirLineDbContext

 
(

  
DbContextOptions

  0
options

1 8
)

8 9
:

9 :
base

: >
(

> ?
options

? F
)

F G
{

G H
}

H I
public 
AirLineDbContext 
(  
)  !
{ 	
} 	
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
builder= D
)D E
{ 	
builder 
. 
Entity 
< 
User 
>  
(  !
)! "
." #
HasIndex# +
(+ ,
u, -
=>- /
u/ 0
.0 1
Email1 6
)6 7
.7 8
IsUnique8 @
(@ A
)A B
;B C
builder 
. 
Entity 
< 
Role 
>  
(  !
)! "
." #
HasIndex# +
(+ ,
r, -
=>- /
r/ 0
.0 1
Name1 5
)5 6
.6 7
IsUnique7 ?
(? @
)@ A
;A B
} 	
} 
} 1
nC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Data\Migrations\20220827062258_initial.cs
	namespace 	
AirLines
 
. 
Data 
. 

Migrations "
{ 
public 

partial 
class 
initial  
:! "
	Migration# ,
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
falseQ V
)V W
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% .
,. /
x0 1
=>2 4
x5 6
.6 7
Id7 9
)9 :
;: ;
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Email 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
type1 5
:5 6
$str7 D
,D E
	maxLengthF O
:O P
$numQ S
,S T
nullableU ]
:] ^
false_ d
)d e
,e f
	PanNumber 
= 
table  %
.% &
Column& ,
<, -
string- 3
>3 4
(4 5
type5 9
:9 :
$str; H
,H I
	maxLengthJ S
:S T
$numU W
,W X
nullableY a
:a b
falsec h
)h i
,i j
Password   
=   
table   $
.  $ %
Column  % +
<  + ,
string  , 2
>  2 3
(  3 4
type  4 8
:  8 9
$str  : G
,  G H
	maxLength  I R
:  R S
$num  T V
,  V W
nullable  X `
:  ` a
false  b g
)  g h
,  h i
ConfirmPassword!! #
=!!$ %
table!!& +
.!!+ ,
Column!!, 2
<!!2 3
string!!3 9
>!!9 :
(!!: ;
type!!; ?
:!!? @
$str!!A N
,!!N O
nullable!!P X
:!!X Y
false!!Z _
)!!_ `
,!!` a
Status"" 
="" 
table"" "
.""" #
Column""# )
<"") *
string""* 0
>""0 1
(""1 2
type""2 6
:""6 7
$str""8 G
,""G H
nullable""I Q
:""Q R
false""S X
)""X Y
,""Y Z
RoleId## 
=## 
table## "
.##" #
Column### )
<##) *
int##* -
>##- .
(##. /
type##/ 3
:##3 4
$str##5 :
,##: ;
nullable##< D
:##D E
false##F K
)##K L
}$$ 
,$$ 
constraints%% 
:%% 
table%% "
=>%%# %
{&& 
table'' 
.'' 

PrimaryKey'' $
(''$ %
$str''% .
,''. /
x''0 1
=>''2 4
x''5 6
.''6 7
Id''7 9
)''9 :
;'': ;
}(( 
)(( 
;(( 
migrationBuilder** 
.** 
CreateIndex** (
(**( )
name++ 
:++ 
$str++ $
,++$ %
table,, 
:,, 
$str,, 
,,, 
column-- 
:-- 
$str-- 
,-- 
unique.. 
:.. 
true.. 
).. 
;.. 
migrationBuilder00 
.00 
CreateIndex00 (
(00( )
name11 
:11 
$str11 %
,11% &
table22 
:22 
$str22 
,22 
column33 
:33 
$str33 
,33  
unique44 
:44 
true44 
)44 
;44 
}55 	
	protected77 
override77 
void77 
Down77  $
(77$ %
MigrationBuilder77% 5
migrationBuilder776 F
)77F G
{88 	
migrationBuilder99 
.99 
	DropTable99 &
(99& '
name:: 
::: 
$str:: 
):: 
;:: 
migrationBuilder<< 
.<< 
	DropTable<< &
(<<& '
name== 
:== 
$str== 
)== 
;== 
}>> 	
}?? 
}@@ Â
tC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Data\Migrations\20220827063221_addConstraint.cs
	namespace 	
AirLines
 
. 
Data 
. 

Migrations "
{ 
public 

partial 
class 
addConstraint &
:' (
	Migration) 2
{ 
	protected		 
override		 
void		 
Up		  "
(		" #
MigrationBuilder		# 3
migrationBuilder		4 D
)		D E
{

 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str 
, 
table 
: 
$str 
, 
type 
: 
$str #
,# $
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
)( )
;) *
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str 
, 
table 
: 
$str 
, 
type 
: 
$str #
,# $
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
)( )
;) *
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str 
, 
table   
:   
$str   
,   
type!! 
:!! 
$str!! %
,!!% &
nullable"" 
:"" 
false"" 
,""  

oldClrType## 
:## 
typeof## "
(##" #
string### )
)##) *
,##* +
oldType$$ 
:$$ 
$str$$ &
)$$& '
;$$' (
migrationBuilder&& 
.&& 
AlterColumn&& (
<&&( )
string&&) /
>&&/ 0
(&&0 1
name'' 
:'' 
$str'' 
,'' 
table(( 
:(( 
$str(( 
,(( 
type)) 
:)) 
$str)) %
,))% &
nullable** 
:** 
false** 
,**  

oldClrType++ 
:++ 
typeof++ "
(++" #
string++# )
)++) *
,++* +
oldType,, 
:,, 
$str,, &
),,& '
;,,' (
}-- 	
}.. 
}// ¦
\C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Mapper\MapperProfile.cs
	namespace 	
AirLines
 
. 
Mapper 
{ 
public 

class 
MapperProfile 
: 
Profile &
{ 
public		 
MapperProfile		 
(		 
)		 
{

 	
	CreateMap 
< 
AirLineApiModel %
,% &
AirlineViewModel' 7
>7 8
(8 9
)9 :
.: ;

ReverseMap; E
(E F
)F G
;G H
} 	
} 
} 
_C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Models\AirlineViewModel.cs
	namespace 	
AirLines
 
. 
Models 
{ 
public 

class 
AirlineViewModel !
{ 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
[		 	
Key			 
]		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
[ 	
Required	 
] 
[ 	
	MaxLength	 
( 
$num 
) 
] 
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
, 
	MaxLength 
( 
$num 
)  
]  !
public 
string 
? 
FromCity 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Required	 
, 
	MaxLength 
( 
$num 
)  
]  !
public 
string 
? 
ToCity 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
] 
public 
int 
Fare 
{ 
get 
; 
set "
;" #
}$ %
} 
} ¶
]C:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Models\ErrorViewModel.cs
	namespace 	
AirLines
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
? 
	RequestId  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
bool 
ShowRequestId !
=>" $
!% &
string& ,
., -
IsNullOrEmpty- :
(: ;
	RequestId; D
)D E
;E F
} 
}		 Ý
SC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Models\Role.cs
	namespace 	
AirLines
 
. 
Models 
{ 
public 

class 
Role 
{ 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
[		 	
Key			 
]		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
} 
} ù
SC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Models\User.cs
	namespace 	
AirLines
 
. 
Models 
{ 
public 

class 
User 
{ 
[

 	
DatabaseGenerated

	 
(

 #
DatabaseGeneratedOption

 2
.

2 3
Identity

3 ;
)

; <
]

< =
[ 	
Key	 
] 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
] 
[ 	
	MaxLength	 
( 
$num 
) 
] 
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
public 
string 
? 
Email 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
] 
[ 	
	MaxLength	 
( 
$num 
) 
, 
	MinLength !
(! "
$num" $
)$ %
]% &
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
public 
string 
? 
	PanNumber !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage &
=' (
$str) g
,g h
MinimumLengthi v
=w x
$numy z
)z {
]{ |
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
public 
string 
? 
Password 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
[ 	
Compare	 
( 
$str 
, 
ErrorMessage )
=* +
$str, b
)b c
]c d
public 
string 
? 
ConfirmPassword &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
[ 	
Required	 
] 
[ 	
Column	 
( 
TypeName 
= 
$str (
)( )
]) *
[ 	
DefaultValue	 
( 
$str 
)  
]  !
public   
string   
?   
Status   
{   
get    #
;  # $
set  % (
;  ( )
}  * +
[!! 	
Required!!	 
]!! 
public"" 
int"" 
RoleId"" 
{"" 
get"" 
;""  
set""! $
;""$ %
}""& '
}$$ 
}%% Ú
OC:\Users\MICROBYTE COMPUTERS\source\repos\AirlineAssignment\AirLines\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder

 
.

 
Services

 
.

 
AddDbContext

 
<

 
AirLineDbContext

 .
>

. /
(

/ 0
option

0 6
=>

7 9
option

: @
.

@ A
UseSqlServer

A M
(

M N
builder

N U
.

U V
Configuration

V c
.

c d
GetConnectionString

d w
(

w x
$str	

x 
)


 
??


 
throw


 
new


 '
InvalidOperationException


 ¬
(


¬ ­
$str


­ Ë
)


Ë Ì
)


Ì Í
)


Í Î
;


Î Ï
builder 
. 
Services 
. 
AddAutoMapper 
( 
typeof %
(% &
Program& -
)- .
). /
;/ 0
builder 
. 
Services 
. #
AddControllersWithViews (
(( )
)) *
;* +
builder 
. 
Services 
. %
AddDistributedMemoryCache *
(* +
)+ ,
;, -
builder 
. 
Services 
. 

AddSession 
( 
options #
=>$ &
{ 
options 
. 
IdleTimeout 
= 
TimeSpan "
." #
FromMinutes# .
(. /
$num/ 1
)1 2
;2 3
options 
. 
Cookie 
. 
HttpOnly 
= 
true "
;" #
options 
. 
Cookie 
. 
IsEssential 
=  
true! %
;% &
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
! 
app 
. 	
Environment	 
. 
IsDevelopment "
(" #
)# $
)$ %
{ 
app 
. 
UseExceptionHandler 
( 
$str )
)) *
;* +
app 
. 
UseHsts 
( 
) 
; 
} 
app   
.   
UseHttpsRedirection   
(   
)   
;   
app!! 
.!! 
UseStaticFiles!! 
(!! 
)!! 
;!! 
app## 
.## 

UseRouting## 
(## 
)## 
;## 
app%% 
.%% 
UseAuthorization%% 
(%% 
)%% 
;%% 
app&& 
.&& 

UseSession&& 
(&& 
)&& 
;&& 
app'' 
.'' 
MapControllerRoute'' 
('' 
name(( 
:(( 	
$str((
 
,(( 
pattern)) 
:)) 
$str)) 5
)))5 6
;))6 7
app++ 
.++ 
Run++ 
(++ 
)++ 	
;++	 
